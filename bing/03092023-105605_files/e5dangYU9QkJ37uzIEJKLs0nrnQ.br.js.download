var SydneyFullScreenConv;(function(n){function ui(n){var b,k,d,tt,it,rt,ut,et,st,ht,yt,pt,wt,ti,ui,ei,si,hi,li,ai,vi,yi,pi,wi,ki,di,gi,tr,rr,ur,fr,er,a,or,br,dr,ar,gr,yr,r,y,l,pr;if(n===void 0&&(n=null),a=_ge(ci),!a.querySelector("cib-serp")){ct=(b=_w._sydConvConfig)===null||b===void 0?void 0:b.usePill;lt=(k=_w._sydConvConfig)===null||k===void 0?void 0:k.enableScrollOut;at=(d=_w._sydConvConfig)===null||d===void 0?void 0:d.enableSydContext;v=(tt=_w._sydConvConfig)===null||tt===void 0?void 0:tt.enableSydHistory;nr=(it=_w._sydConvConfig)===null||it===void 0?void 0:it.enableSydTigerAns;bt=(rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSydAjax;ft=(ut=_w._sydConvConfig)===null||ut===void 0?void 0:ut.enableSydCarousel;nt=(et=_w._sydConvConfig)===null||et===void 0?void 0:et.moveOnlySydXAnswers;f=(st=_w._sydConvConfig)===null||st===void 0?void 0:st.hideSydFSC;e=(ht=_w._sydConvConfig)===null||ht===void 0?void 0:ht.enableSydOverlay;vt=(yt=_w._sydConvConfig)===null||yt===void 0?void 0:yt.enable1TCibSlot;g=(pt=_w._sydConvConfig)===null||pt===void 0?void 0:pt.enableSydX1T;kt=(wt=_w._sydConvConfig)===null||wt===void 0?void 0:wt.hideSydMic;dt=(ti=_w._sydConvConfig)===null||ti===void 0?void 0:ti.fromNoResults;ii=(ui=_w._sydConvConfig)===null||ui===void 0?void 0:ui.checkCreatorAnsFor1T;ot=SydFSCHelper.getConfigOrDefault((ei=_w._sydConvConfig)===null||ei===void 0?void 0:ei.enableSydCarouselHistory,!1);gt=SydFSCHelper.getConfigOrDefault((si=_w._sydConvConfig)===null||si===void 0?void 0:si.enableSQMsg,!1);ni=SydFSCHelper.getConfigOrDefault((hi=_w._sydConvConfig)===null||hi===void 0?void 0:hi.enableSemSerpNoCache,!1);ri=SydFSCHelper.getConfigOrDefault((li=_w._sydConvConfig)===null||li===void 0?void 0:li.enableSydStaticAdsLink,!1);var nu=SydFSCHelper.getConfigOrDefault((ai=_w._sydConvConfig)===null||ai===void 0?void 0:ai.hideSydReconnect,!1),tu=(vi=_w._sydConvConfig)===null||vi===void 0?void 0:vi.enableDlBing,iu=(yi=_w._sydConvConfig)===null||yi===void 0?void 0:yi.disableSydGhosting,ru=SydFSCHelper.getConfigOrDefault((pi=_w._sydConvConfig)===null||pi===void 0?void 0:pi.disableCibNotificationStyleUpdate,!1),uu=_w._sydCachedString,wr=_w._sydAddOptionsSet;if(_G[SydFSCHelper.SYD_MODE]="serp",_G[SydFSCHelper.SYD_PREV_MODE]="",p=_d.createElement("slot"),p.setAttribute("name","firstAnswer"),p.setAttribute("slot","firstAns"),w=_d.createElement("slot"),w.setAttribute("name","firstAns"),u=((wi=_d.getElementsByClassName("b_poleContent"))===null||wi===void 0?void 0:wi.length)>0?_d.getElementsByClassName("b_poleContent")[0]:null,t=((ki=_d.getElementsByClassName("b_top"))===null||ki===void 0?void 0:ki.length)>0?_d.getElementsByClassName("b_top")[0]:null,o=!t?!1:t.getElementsByClassName("b_wpt_ch").length>0||t.getElementsByClassName("qna-sydney").length>0,bi=_d.querySelector("#wpt_ssp"),or=_ge("b_header"),a&&or&&sj_b.insertBefore(a,or),i=_d.createElement("div"),i===null||i===void 0?void 0:i.setAttribute("slot","firstAnswer"),i===null||i===void 0?void 0:i.setAttribute("id","sydFirstAnswer"),i.style.maxWidth="648px",SydFSCHelper.setConfigs(n),br=SydFSCHelper.getConfigOrDefault((di=_w._sydConvConfig)===null||di===void 0?void 0:di.isCompliantSydneyEndpointEnabled,!1),br&&SydFSCHelper.addTenantLogoToHeader(),SydFSCHelper.setEventListeners(),SydFSCHelper.setSydFSCEligibleState(!0),s=CIB.insertAt(a),s.setAttribute("alignment","left"),tu&&CIB.config.sydney.request.optionsSets.push("dlbing"),wr&&CIB.config.sydney.request.optionsSets.push(wr),dt)SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim();else{CIB.config.greeting.shouldSendBotGreeting=!1;CIB.onConversationRequestStateChange(function(n){n||CIB.config.greeting.shouldSendBotGreeting||(CIB.config.greeting.shouldSendBotGreeting=!0)})}dr=SydFSCHelper.getConfigOrDefault((gi=_w._sydConvConfig)===null||gi===void 0?void 0:gi.disResetTT,!1);dr&&(ar=(rr=(tr=s===null||s===void 0?void 0:s.shadowRoot)===null||tr===void 0?void 0:tr.querySelector("cib-action-bar"))===null||rr===void 0?void 0:rr.shadowRoot,ar&&(l=sj_ce("style"),l.textContent="\n                    cib-tooltip {\n                        display: none !important;\n                    }\n                ",ar.appendChild(l)));SydFSCHelper.setForceCache();ot&&(gr=new URLSearchParams(_w.location.search),yr=gr.get("convid"),yr&&kr(yr));r=(ur=_d.querySelector("cib-serp"))===null||ur===void 0?void 0:ur.shadowRoot;y=r===null||r===void 0?void 0:r.querySelector("cib-conversation");y&&y.shadowRoot&&(h=y.shadowRoot.querySelector(".scroller"),l=sj_ce("style"),nu&&(l.textContent="\n                cib-notification-container {\n                    display: none;\n                }\n            "),y.shadowRoot.appendChild(l));iu&&(pr=(er=(fr=r===null||r===void 0?void 0:r.querySelector("cib-action-bar"))===null||fr===void 0?void 0:fr.shadowRoot)===null||er===void 0?void 0:er.querySelector(".autosuggest-text"),pr&&(pr.style.display="none"));e||(sj_be(_w,"mousewheel",sr),sj_be(_w,"touchstart",hr),sj_be(_w,"touchmove",cr),sj_be(_w,"touchend",lr));SydFSCHelper.triggerShareFlow();fi();sj_evt.bind("ajax.load",fi);v&&(SydFSCHelper.setupHistory(),SydFSCHelper.checkInitialState());ir();e&&vr();SydFSCHelper.triggerClarity();CIB.onResetConversation(function(){SydFSCHelper.shouldMove1TAnswers(g,c)&&oi();SydFSCHelper.lastQuery=""})}}function fi(){sj_evt.bind("hideSydFSC",function(n){var u,t,i,h,r;if(!ut){if(ut=!0,Log.Log("ClientInst","Codex","LeaveConversationMode"),f||Lib.CssClass.remove(sj_b,tt),u=_ge("sb_form"),u&&Lib.CssClass.contains(u,"hassbi")&&Lib.CssClass.remove(u,"hassbi"),CIB.hideConversation(),f||e||(Lib.CssClass.add(_d.documentElement,"b_delayOvflw"),SydFSCHelper.shouldMove1TAnswers(g,c)&&oi(),t=_ge("b-scopeListItem-web"),t&&t.children.length>0&&(t.parentElement.removeAttribute("role"),t.children[0].setAttribute("aria-current","page"),t.children[0].removeAttribute("aria-selected"),t.children[0].removeAttribute("role"),Lib.CssClass.add(t,"b_active"),_ge("b_skip_to_content").setAttribute("tabindex","0")),i=_ge("b-scopeListItem-conv"),i&&i.children.length>0&&(i.children[0].removeAttribute("role"),i.children[0].removeAttribute("aria-selected"),i.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(i,"b_active"))),_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],v&&(h=n&&n.length>1?n[1]:!1,h||SydFSCHelper.pushSydHistory(!1))),_G[SydFSCHelper.SYD_MODE]="serp",ft)pr();else if(bt&&(r=CIB.vm.conversation.model.messages.filter(function(n){return n.type==="meta"&&n.text!="Generating answers for you..."||n.type==="text"&&n.author==="user"}),r&&r.length>0)){var o=r[r.length-1].text.split("`"),s=o.length==1?o[0]:o.length==3?o[1]:"",l=_ge("sb_form_go"),a=_ge("sb_form_q");_w.sj_isAjax&&s&&a.value.toLowerCase()!=s.toLowerCase()&&l&&(a.value=s,SydFSCHelper.lastQuery=s,l.click())}ut=!1}});sb_st(function(){sj_evt.bind("showSydFSC",fr,!0)},0);sj_evt.fire("convInit:done")}function tr(){var n,i;u=((n=_d.getElementsByClassName("b_poleContent"))===null||n===void 0?void 0:n.length)>0?_d.getElementsByClassName("b_poleContent")[0]:null;t=((i=_d.getElementsByClassName("b_top"))===null||i===void 0?void 0:i.length)>0?_d.getElementsByClassName("b_top")[0]:null;y=t===null||t===void 0?void 0:t.previousSibling;yt=sj_b.querySelector("#b_sydTigerCont")!=null;o=!!t&&t.querySelector("#sydwrap_wrapper")!=null;nt&&(r=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat .b_wpt_chat"),r&&(Lib.CssClass.add(r,pt),ti=r.querySelector(".b_wpt_creator_content")!=null))}function ir(){var n=_ge("id_hbfo");sj_be(n,"click",function(n){var r=n.target,t,i;_G[SydFSCHelper.SYD_MODE]=="conversation"&&r&&(t=rr(r),t&&t.target!="_blank"&&(i="",t.href.indexOf("/profile/")>=0?i="profile":t.href.indexOf("/account/")>=0&&(i="account"),SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"ClickMenu",target:i})))})}function rr(n){while(n!=null){if(n.tagName=="A"&&Lib.CssClass.contains(n,"hb_section"))return n;n=n.parentElement}return null}function ei(n){var r,i,t;if(!n||n.querySelector("#b_sydTigerCont")!=null||n.querySelector("#b_wpt_creator_content")!=null||n.querySelector("#b_metaCont")!=null)return!1;for(i=0;n.children&&i<n.children.length;i++)if(t=n.children[i],t&&!Lib.CssClass.contains(t,"b_unar")&&t.getElementsByClassName("b_unar").length==0&&!Lib.CssClass.contains(t,"b_wpTabsWrapper")&&t.getElementsByClassName("b_wpTabsWrapper").length==0&&!Lib.CssClass.contains(t,"b_rs_pole")&&t.getElementsByClassName("b_rs_pole").length==0&&!Lib.CssClass.contains(t,"fin_sc")&&t.getElementsByClassName("fin_sc").length==0&&!Lib.CssClass.contains(t,"fin_scTitleLink")&&t.getElementsByClassName("fin_scTitleLink").length==0&&!Lib.CssClass.contains(t,"lite-entcard-mainpole")&&t.getElementsByClassName("lite-entcard-mainpole").length==0&&((r=t.id)===null||r===void 0?void 0:r.indexOf("testhook_"))==-1)return!0;return!1}function a(n,t,i){i===void 0&&(i=!1);t&&n&&(i?n.prepend(t):n.appendChild(t))}function st(n){var u,f,e,o,s,h;if(!ct){a(_ge("b_sydtoporpole"),n);return}var l=_d.querySelector("cib-serp"),t=(f=(u=_d.querySelector("cib-serp"))===null||u===void 0?void 0:u.shadowRoot)===null||f===void 0?void 0:f.querySelector("cib-conversation"),r=(o=(e=t===null||t===void 0?void 0:t.shadowRoot)===null||e===void 0?void 0:e.querySelector(".scroller"))===null||o===void 0?void 0:o.querySelector(".main cib-welcome-container"),c=(h=(s=t===null||t===void 0?void 0:t.shadowRoot)===null||s===void 0?void 0:s.querySelector(".scroller"))===null||h===void 0?void 0:h.querySelector(".main");t===null||t===void 0?void 0:t.appendChild(p);r?r===null||r===void 0?void 0:r.after(w):c===null||c===void 0?void 0:c.prepend(w);i===null||i===void 0?void 0:i.appendChild(n);vt;a(l,i)}function ur(){if(tr(),nt){if(!r||ii&&ti)return;(c||o&&!yt)&&sb_st(function(){st(r)},it)}else ei(u)&&!o?sb_st(function(){st(u)},it):t&&sb_st(function(){st(t)},it)}function oi(){if(nt){if(!r)return;var n=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat");n&&!n.contains(r)&&(Lib.CssClass.remove(r,pt),a(n,r,!0))}else ei(u)&&!o?a(_ge("b_pole"),u):t&&(y&&y.parentElement?y.after(t):a(_ge("b_results"),t,!0))}function fr(n){var h,l,a,y,p,u,o,b,t,i,r,s,d;if(!rt){rt=!0;Log.Log("ClientInst","Codex","EnterConversationMode");CIB.config.features.enableAds=!0;ni&&(p=CIB.config.sydney.request.optionsSets.indexOf("nocacheread"),p>=0&&CIB.config.sydney.request.optionsSets.splice(p,1));u=_ge("b_header");u&&Lib.CssClass.contains(u,ht)&&(Lib.CssClass.remove(u,ht),SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ShowConv"}));ft&&hi();o=n&&n.length>1?n[1]:null;b=n&&n.length>2?n[2]:null;gi=n&&n.length>3?n[3]==ki:!1;c=n&&n.length>3?n[3]==di:!1;var nt=n&&n.length>5?n[5]:null,it=n&&n.length>6?n[6]:!1,w=n&&n.length>7?n[7]:!1;if(f||e||(_w.scrollY>0&&_w.scrollTo(0,0),Lib.CssClass.add(_d.documentElement,"b_disOvflw"),Lib.CssClass.remove(_d.documentElement,"b_delayOvflw")),f||Lib.CssClass.add(sj_b,tt),SydFSCHelper.shouldMove1TAnswers(g,c,o)&&ur(),o&&or(o.toLowerCase().trim(),b,nt,w),CIB.showConversation(),it&&(CIB.toggleSpeechEnabled(),CIB.triggerMic()),!f&&!e&&(t=_ge("b-scopeListItem-web"),t&&t.children.length>0&&(t.parentElement.setAttribute("role","tablist"),t.children[0].setAttribute("aria-current","false"),t.children[0].setAttribute("aria-selected","false"),t.children[0].setAttribute("role","tab"),Lib.CssClass.remove(t,"b_active")),i=_ge("b-scopeListItem-conv"),i&&i.children.length>0&&(i.children[0].setAttribute("aria-current","page"),i.children[0].setAttribute("role","tab"),i.children[0].setAttribute("aria-selected","true"),Lib.CssClass.add(i,"b_active"),_ge("b_skip_to_content").setAttribute("tabindex","-1")),r=_d.querySelector(".b_sydConvMode"),s=(y=(a=(l=(h=r===null||r===void 0?void 0:r.querySelector("cib-serp"))===null||h===void 0?void 0:h.shadowRoot)===null||l===void 0?void 0:l.querySelector("cib-action-bar"))===null||a===void 0?void 0:a.shadowRoot)===null||y===void 0?void 0:y.querySelector(".input-container .text-input textarea"),w||s.focus(),r&&s&&w)){sj_be(r,"keyup",k);function k(n){(n.code=="Tab"||n.keyCode==9||n.key=="Tab")&&s.focus();r.removeEventListener("keyup",k)}}_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],v&&(d=n&&n.length>4?n[4]:!1,d||SydFSCHelper.pushSydHistory(!0)));er();_G[SydFSCHelper.SYD_MODE]="conversation";rt=!1}}function er(){var n=ClientObserver.getBrowserWidth(),t=ClientObserver.getBrowserHeight();SydFSCHelper.set2TQueryConfigs(n,t,ri)}function or(n,t,i,r){if(n&&n!=SydFSCHelper.lastQuery){var u=[];i&&u.push({author:"user",text:i});t&&u.push({author:"bot",text:t});at&&u.length!=0&&CIB.registerContext(u);gt&&r&&!CIB.manager.conversation._lastMessage?CIB.sendSearchQuery(n):CIB.addMessage(n);SydFSCHelper.lastQuery=n}}function sr(n){var t=0;n||(n=window.event);n.wheelDelta?t=n.wheelDelta/60:n.detail&&(t=-n.detail/2);si(t,li)}function hr(n){et=n.changedTouches[0].clientY}function cr(n){var t=n.changedTouches[0].clientY-et;si(t,ai,!0)}function lr(){l=0;b=!1;k=!1;et=0}function si(n,t,i){i===void 0&&(i=!1);sb_ct(wt);b||(d=Lib.CssClass.contains(sj_b,tt),k=d?ar():_w.scrollY==0);b=!0;k&&(l+=n);i||(wt=sb_st(function(){l=0;b=!1;k=!1},150));!d&&l>t&&_G[SydFSCHelper.SYD_MODE]!="conversation"?(SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ScrollUp"}),SydFSCHelper.triggerSydFSCQueryWithContext()):lt&&d&&l<-1*t&&_G[SydFSCHelper.SYD_MODE]=="conversation"&&(SydFSCHelper.LogIntEvent("ConversationViewExit","Scope",{source:"ScrollDown",target:_G[SydFSCHelper.SYD_PREV_MODE]}),sj_evt.fire("hideSydFSC"),sb_st(function(){_w.scrollTo(0,0)},1))}function ar(){return!h?!1:Math.abs(h.scrollTop-(h.scrollHeight-h.offsetHeight))<1}function vr(){var t,i,r,e=_ge("b_sydOvrClose"),n,u,f;e&&sj_be(e,"click",function(){sj_evt.fire("hideSydFSC")});n=(r=(i=(t=_d.querySelector("#b_sydConvCont cib-serp"))===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("cib-action-bar"))===null||r===void 0?void 0:r.shadowRoot;u=n===null||n===void 0?void 0:n.querySelector(".outside-left-container");u&&(u.style.display="none");kt&&n&&(f=sj_ce("style"),f.textContent="\n                .control.microphone {\n                    display: none;\n                }\n            ",n.appendChild(f))}function yr(n){var t,i;n===void 0&&(n=null);i=(t=_w._sydPayWallConfig)===null||t===void 0?void 0:t.loadSydneyConvResWithPayWall;i?sj_evt.bind("waitlistUpdate:eligible",ui,!0):ui(n)}function pr(){var n=_ge("b_pole"),t,i;n||(n=sj_ce("div","b_pole"),t=_d.querySelector("main"),i=_ge("b_results"),t&&i&&t.insertBefore(n,i));wr(n)}function wr(n){var c,l,a,v,f,k,i,u,w,tt,s,t,h,it;hi();var r=sj_ce("div","b_metaCont"),b=sj_ce("div","b_metaCont_Title"),rt=SydFSCHelper.getConfigOrDefault((c=_w._sydConvTranslation)===null||c===void 0?void 0:c.sydneyCarouselTitle,"");b.textContent=rt;r.appendChild(b);f=sj_ce("div","b_meta_bot");r.appendChild(f);k=sj_ce("div","b_metaChat");f.appendChild(k);i=sj_ce("div","b_metaCont_PillCont","b_meta_hideEx");f.appendChild(i);var d=SydFSCHelper.getConfigOrDefault((l=_w._sydConvConfig)===null||l===void 0?void 0:l.carouselQueries,""),ut=SydFSCHelper.getConfigOrDefault((a=_w._sydConvConfig)===null||a===void 0?void 0:a.sydCarPropQuery,!1),g=d?d.split(","):null,e=g?g:CIB.vm.conversation.model.messages.filter(function(n){return n.type==="meta"&&n.text!="Generating answers for you..."}).map(function(n){return n.text}),nt=0,ft=vi-wi,et=CIB.vm.conversation.model._id,y=!0;for(u=0;u<e.length;u++){var st=e[u],o=st.split("`"),p=o.length==1?o[0]:o.length==3?o[1]:"";y&&(w=br(p)+2*yi+pi,nt+w<ft?nt+=w:(y=!1,tt=e.length-u,s=sj_ce("div","b_meta_exp","b_metaCont_Pill"),s.innerText="+"+tt.toString(),sj_be(s,"click",function(){Lib.CssClass.add(i,"b_metaExpanded")}),i.append(s)));t=sj_ce("a",null,"b_metaCont_Pill"+(y?"":" b_hide"));t.href=_w.location.origin+_w.location.pathname+"?q="+p;ot&&(t.href=t.href+"&convid="+et);ut&&(t.href=t.href+"&features=sydcarousel,sydcpropq");t.textContent=p;t.target="_blank";sj_be(t,"click",function(n){var i=_ge("CodexCarouselInstLink"),t;_w.si_ct&&_w.si_ct(i);t=n===null||n===void 0?void 0:n.target;SydFSCHelper.LogIntEvent("QueryCarouselClick","QueryCarousel",{query:t===null||t===void 0?void 0:t.textContent})});i.appendChild(t)}h=sj_ce("div","b_meta_col","b_metaCont_Pill b_hide");h.innerText=SydFSCHelper.getConfigOrDefault((v=_w._sydConvTranslation)===null||v===void 0?void 0:v.sydneyCarouselCollapse,"Collapse");sj_be(h,"click",function(){Lib.CssClass.remove(i,"b_metaExpanded")});i.append(h);e.length>0&&(n.children.length>0?(it=_w.getComputedStyle(n,null),it.paddingLeft=="0px"&&Lib.CssClass.add(r,"b_metaPadding"),n.insertBefore(r,n.children[0])):n.appendChild(r))}function br(n){var i=sj_ce("canvas"),t=i.getContext("2d");return t.font="14px Roboto",t.measureText(n).width}function hi(){var n=_ge("b_metaCont");n&&n.parentElement&&n.parentElement.removeChild(n)}function kr(n){CIB.loadConversation(n);SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim()}var tt="b_sydConvMode",ht="b_sydShowConv",ci="b_sydConvCont",li=10,ai=100,vi=750,yi=16,pi=6,wi=60,ct,lt,at,v,vt=!1,u,t,y,o,r=null,yt=!1,bi,s,h,i,p,w,ki="SSP_WRAPPER",di="SYDX_WRAPPER",gi=!1,c=!1,pt="b_sydxwrappedanswer",it=1e3,rt=!1,ut=!1,l=0,wt,b=!1,k=!1,d=!1,nr=!1,g=!1,bt=!1,ft=!1,f=!1,e=!1,et,nt=!1,kt=!1,dt=!1,ot=!1,gt=!1,ni=!1,ti=!1,ii=!1,ri=!1;(typeof sj_b=="undefined"||sj_b==null)&&(window.sj_b=document.body);n.initWithWaitlistUpdate=yr;sj_evt.fire("sydFSC.init")})(SydneyFullScreenConv||(SydneyFullScreenConv={}))